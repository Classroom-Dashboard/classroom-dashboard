<nav class="navbar navbar-default">
	<div class="container">

    <ul class="nav navbar-nav navbar-left">
      <a href="#"><%= link_to "Flashcards", section_flashcards_path(@section)%></a>
      &nbsp;
      &nbsp;
      &nbsp;
      &nbsp;
      &nbsp;
      <a href="#"><%= link_to "Memory Game", section_quiz_path(@section)%></a>
    </ul>

		<div class="navbar-header">
      <%= link_to @section.course + " " + @section.semester, section_path, class: "navbar-brand" %>
    </div>

		<ul class="nav navbar-nav navbar-right">
      <div style="text-align:right">
        <a href="#"><%= link_to "Student List", section_path%></a>
        &nbsp;
        &nbsp;
        &nbsp;
        &nbsp;
        &nbsp;
        <a href="#"><%= link_to "Add Student", new_section_student_path(@section)%></a>
      </div>
    </ul>
	</div>
</nav>

<br>
<h1> Memory Game </h1>
<br>

<div style="text-align:center">
  <button onclick="reveal()">Reveal/Hide Name</button>
	<button onclick="next()">Next Student</button>

  <br>
  <br>

	<br>

	<div id="image" style="center"></div>

	<div id="name" style="display:none;" style="center"></div>
</div>


<script>
$(document).keydown(function(e) {
	if (e.keyCode == 32) {
		reveal();
	};
});

var student_list = <%= @section.students.all.order("RANDOM()").to_json.html_safe %>;
var n = <%= @section.students.all.length %>;
var i = 0;

render_student(i);

// renders student i in #up-now div
function render_student(i) {
	$("#name").html(student_list[i].firstName + " " + student_list[i].lastname);
	$("#image").html("<br>");
	// account for ID digits in image url
	if (student_list[i].id >= 100) {
		$("#image").append('<img src="/system/students/student_imgs/000/000/' + student_list[i].id + '/student_index/' + student_list[i].student_img_file_name + '" />');
	}
	if (student_list[i].id >= 10) {
		$("#image").append('<img src="/system/students/student_imgs/000/000/0' + student_list[i].id + '/student_index/' + student_list[i].student_img_file_name + '" />');
	}
	else {
		$("#image").append('<img src="/system/students/student_imgs/000/000/00' + student_list[i].id + '/student_index/' + student_list[i].student_img_file_name + '" />');
	}
};

function reveal() {
    var x = document.getElementById("name");
    if (x.style.display === "none") {
        x.style.display = "block";
    } else {
        x.style.display = "none";
    }
};


function next() {
	var x = document.getElementById("name");
	if (x.style.display === "block") {
			x.style.display = "none";
	};
	if (i < n-1) {
		i = i + 1;
	} else {
		i = 0;
		// reached the end, re-randomize
		student_list = student_list.sort(function(a, b){return 0.5 - Math.random()});
	}
	render_student(i);
};

</script>
